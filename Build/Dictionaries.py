
"""
Created on Tue Feb 27 15:58:00 2024

@author: Trevor Gratz, trevormgratz@gmail.com
"""
# Remap if less than 100 obs or if categories are similar
remap = {'HoH_GenderName': {'More than one gender reported':'Other_Missing',
                            'Non-Binary':'Other_Missing',
                            'Missing_NoAnswer_DoesntKnow':'Other_Missing',
                            'Transgender': 'Other_Missing',
                            'Questioning': 'Other_Missing'},
         'HoH_SexualOrientationName': {'Missing_NoAnswer_DoesntKnow': 'Other_Missing',
                                       'Questioning/Unsure':'Other_Missing',
                                       'Other':'Other_Missing',
                                       'Gay':'Gay_Lesbian',
                                       'Lesbian':'Gay_Lesbian'},
         'HoH_LastGradeCompletedNameAtEntry': {'Grades 5-6':'Less than Grade 6',
                                               'Less than Grade 5':'Less than Grade 6'},
         'HoH_DomesticViolenceWhenOccurred': {None:'None_Missing',
                                              'Data not collected (HUD)':'None_Missing',
                                              'Client prefers not to answer (HUD)':'None_Missing',
                                              "Client doesn't know (HUD)":'None_Missing'},
         'HoH_DomesticViolenceCurrentlyFleeing': {None:'None_Other_Missing',
                                                  'Data not collected (HUD)':'None_Other_Missing',
                                                  'Client prefers not to answer (HUD)':'None_Other_Missing',
                                                  "Client doesn't know (HUD)":'None_Other_Missing'},
         'Household_Education': {'nan': 'Missing_NoAnswer_DoesntKnow',
                                 '0': 'Missing_NoAnswer_DoesntKnow',
                                 '1': 'Missing_NoAnswer_DoesntKnow',
                                 '2': 'Missing_NoAnswer_DoesntKnow',
                                 '3': 'Missing_NoAnswer_DoesntKnow',
                                 '8': 'Missing_NoAnswer_DoesntKnow',
                                 '4': 'Less than Grade 6',
                                 '5': 'Less than Grade 6'},
         'Household_MostRecentDomsticViolence' : {"NaN": '0.0',
                                                  None: '0.0',
                                                  1.0: '0.0'} 
         # Leaving HIVAID unchanged as the Yes category is near 100. No other 
         # healthconditions are similalry sparse, so no ability to 
         # reasonably combine them.
         
         }


X_hoh_OHE = ['RRH',
            'TSH',
            'PSH',
            'HoH_RRH_Month_1',
            'HoH_RRH_Month_2',
            'HoH_RRH_Month_3plus',
            'HoH_TSH_Month_1',
            'HoH_TSH_Month_2',
            'HoH_TSH_Month_3plus',
            'HoH_PSH_Month_1',
            'HoH_PSH_Month_2',
            'HoH_PSH_Month_3plus',
            'HoH_AgeAtEntry',
            'ln_rmout_HoH_EmployedHoursWorkedLastWeek',
            'ln_rmout_AverageLHEventsInPast12Months',
            'ln_N_Household',
            'ln_Household_N_Children',
            'HoH_LengthOfStayName_90 days or more, but less than one year',
#           'HoH_LengthOfStayName_Missing_NoAnswer_DoesntKnow',
            'HoH_LengthOfStayName_One month or more, but less than 90 days',
            'HoH_LengthOfStayName_One night or less',
            'HoH_LengthOfStayName_One week or more, but less than one month',
            'HoH_LengthOfStayName_One year or longer',
            'HoH_LengthOfStayName_Two to six nights',
            'HoH_RaceName_American Indian, Alaska Native, or Indigenous',
            'HoH_RaceName_Asian or Asian American',
            'HoH_RaceName_Black, African American, or African',
#            'HoH_RaceName_Missing_NoAnswer_DoesntKnow',
            'HoH_RaceName_Native Hawaiian or Pacific Islander',
            'HoH_RaceName_Two or more races',
            'HoH_RaceName_White',
            'HoH_EthnicityName_Hispanic/Latina/e/o',
 #           'HoH_EthnicityName_Non-Hispanic/Latina/e/o',
            'HoH_GenderName_Man (Boy, if child)',
  #           'HoH_GenderName_Other_Missing',
            'HoH_GenderName_Woman (Girl, if child)',
            'HoH_SexualOrientationName_Bisexual',
            'HoH_SexualOrientationName_Gay_Lesbian',
            'HoH_SexualOrientationName_Heterosexual',
   #         'HoH_SexualOrientationName_Other_Missing',
    #        'HoH_VeteranStatusName_Missing_NoAnswer_DoesntKnow',
            'HoH_VeteranStatusName_No',
            'HoH_VeteranStatusName_Yes',
            'HoH_TimesHomelessPastThreeYearsName_Four or more times',
     #        'HoH_TimesHomelessPastThreeYearsName_Missing_NoAnswer_DoesntKnow',
            'HoH_TimesHomelessPastThreeYearsName_One time',
            'HoH_TimesHomelessPastThreeYearsName_Three times',
            'HoH_TimesHomelessPastThreeYearsName_Two times',
            "HoH_LastGradeCompletedNameAtEntry_Associate's degree",
            "HoH_LastGradeCompletedNameAtEntry_Bachelor's degree",
            'HoH_LastGradeCompletedNameAtEntry_GED',
            'HoH_LastGradeCompletedNameAtEntry_Grade 12/High school diploma',
            'HoH_LastGradeCompletedNameAtEntry_Grades 7-8',
            'HoH_LastGradeCompletedNameAtEntry_Grades 9-11',
            'HoH_LastGradeCompletedNameAtEntry_Graduate degree',
            'HoH_LastGradeCompletedNameAtEntry_Less than Grade 6',
#            'HoH_LastGradeCompletedNameAtEntry_Missing_NoAnswer_DoesntKnow',
            'HoH_LastGradeCompletedNameAtEntry_Some college',
            'HoH_LastGradeCompletedNameAtEntry_Vocational certification',
#            'HoH_Employed_Missing_NoAnswer_DoesntKnow',
            'HoH_Employed_No (HUD)',
            'HoH_Employed_Yes (HUD)',
#             'HoH_IncomeFromAnySource_Missing_NoAnswer_DoesntKnow',
            'HoH_IncomeFromAnySource_No (HUD)',
            'HoH_IncomeFromAnySource_Yes (HUD)',
            'HoH_HouseholdPercentofAMI_10% - <30%',
            'HoH_HouseholdPercentofAMI_30% - < 50%',
            'HoH_HouseholdPercentofAMI_50% - <80%',
            'HoH_HouseholdPercentofAMI_< 10%',
#             'HoH_HouseholdPercentofAMI_Missing_NoAnswer_DoesntKnow',
#             'HoH_NonCashBenefitFromAnySource_Missing_NoAnswer_DoesntKnow',
            'HoH_NonCashBenefitFromAnySource_No (HUD)',
            'HoH_NonCashBenefitFromAnySource_Yes (HUD)',
#             'HoH_CoveredByHealthInsurance_Missing_NoAnswer_DoesntKnow',
            'HoH_CoveredByHealthInsurance_No (HUD)',
            'HoH_CoveredByHealthInsurance_Yes (HUD)',
#            'HoH_DisablingCondition_Missing_NoAnswer_DoesntKnow',
            'HoH_DisablingCondition_No (HUD)',
            'HoH_DisablingCondition_Yes (HUD)',
#             'HoH_Pregnant_Missing_NoAnswer_DoesntKnow',
            'HoH_Pregnant_No (HUD)',
            'HoH_Pregnant_Yes (HUD)',
#           'HoH_DomesticViolenceSurvivor_Missing_NoAnswer_DoesntKnow',
            'HoH_DomesticViolenceSurvivor_No (HUD)',
            'HoH_DomesticViolenceSurvivor_Yes (HUD)',
#            'HoH_DomesticViolenceWhenOccurred_Client prefers not to answer',
            'HoH_DomesticViolenceWhenOccurred_From six to twelve months ago (HUD)',
            'HoH_DomesticViolenceWhenOccurred_More than a year ago (HUD)',
            'HoH_DomesticViolenceWhenOccurred_None_Missing',
            'HoH_DomesticViolenceWhenOccurred_Three to six months ago (HUD)',
            'HoH_DomesticViolenceWhenOccurred_Within the past three months (HUD)',
            'HoH_DomesticViolenceCurrentlyFleeing_No (HUD)',
#            'HoH_DomesticViolenceCurrentlyFleeing_None_Other_Missing',
            'HoH_DomesticViolenceCurrentlyFleeing_Yes (HUD)',
#            'HoH_PhysicalDisability_Missing_NoAnswer_DoesntKnow',
            'HoH_PhysicalDisability_No',
            'HoH_PhysicalDisability_Yes',
#            'HoH_DevelopmentalDisability_Missing_NoAnswer_DoesntKnow',
            'HoH_DevelopmentalDisability_No',
            'HoH_DevelopmentalDisability_Yes',
#            'HoH_ChronicHealthCondition_Missing_NoAnswer_DoesntKnow',
            'HoH_ChronicHealthCondition_No',
            'HoH_ChronicHealthCondition_Yes',
#            'HoH_HIVAIDS_Missing_NoAnswer_DoesntKnow',
            'HoH_HIVAIDS_No',
            'HoH_HIVAIDS_Yes',
#            'HoH_MentalHealth_Missing_NoAnswer_DoesntKnow',
            'HoH_MentalHealth_No',
            'HoH_MentalHealth_Yes',
            'HoH_SubstanceAbuse_Alcohol abuse',
            'HoH_SubstanceAbuse_Both alcohol and drug abuse',
            'HoH_SubstanceAbuse_Drug abuse',
#            'HoH_SubstanceAbuse_Missing_NoAnswer_DoesntKnow',
            'HoH_SubstanceAbuse_No',
            'HoH_Unemployment_0.0',
            'HoH_Unemployment_1.0',
#            'HoH_Unemployment_Missing_NoAnswer_DoesntKnow',
            'HoH_SSI_0.0',
            'HoH_SSI_1.0',
#            'HoH_SSI_Missing_NoAnswer_DoesntKnow',
            'HoH_SSDI_0.0',
            'HoH_SSDI_1.0',
#            'HoH_SSDI_Missing_NoAnswer_DoesntKnow',
            'HoH_VADisabilityService_0.0',
            'HoH_VADisabilityService_1.0',
#            'HoH_VADisabilityService_Missing_NoAnswer_DoesntKnow',
            'HoH_TANF_0.0',
            'HoH_TANF_1.0',
#            'HoH_TANF_Missing_NoAnswer_DoesntKnow',
            'HoH_GA_0.0',
            'HoH_GA_1.0',
#            'HoH_GA_Missing_NoAnswer_DoesntKnow',
            'HoH_SocSecRetirement_0.0',
            'HoH_SocSecRetirement_1.0',
#            'HoH_SocSecRetirement_Missing_NoAnswer_DoesntKnow',
            'HoH_ChildSupport_0.0',
            'HoH_ChildSupport_1.0',
#            'HoH_ChildSupport_Missing_NoAnswer_DoesntKnow',
            'HoH_SNAP_0.0',
            'HoH_SNAP_1.0',
#            'HoH_SNAP_Missing_NoAnswer_DoesntKnow',
#            'Household_N_children0_3_0',
            'Household_N_children0_3_1',
            'Household_N_children0_3_2+',
 #           'Household_N_children3_5_0',
            'Household_N_children3_5_1',
            'Household_N_children3_5_2+',
#            'Household_N_children5_10_0',
            'Household_N_children5_10_1',
            'Household_N_children5_10_2+',
#            'Household_N_children10_15_0',
            'Household_N_children10_15_1',
            'Household_N_children10_15_2+',
#            'Household_N_children15_17_0',
            'Household_N_children15_17_1',
            'Household_N_children15_17_2+',
#            'HoH_OtherIncomeCombined_0',
            'HoH_OtherIncomeCombined_1'
             ] 

X_house_OHE = ['RRH',
            'TSH',
            'PSH',
            'HoH_RRH_Month_1',
            'HoH_RRH_Month_2',
            'HoH_RRH_Month_3plus',
            'HoH_TSH_Month_1',
            'HoH_TSH_Month_2',
            'HoH_TSH_Month_3plus',
            'HoH_PSH_Month_1',
            'HoH_PSH_Month_2',
            'HoH_PSH_Month_3plus',
            'HoH_AgeAtEntry',
            'ln_rmout_AverageLHEventsInPast12Months',
            'ln_rmout_HoH_EmployedHoursWorkedLastWeek',
            'ln_N_Household',
            'ln_Household_N_Children',
            'HoH_LengthOfStayName_90 days or more, but less than one year',
#           'HoH_LengthOfStayName_Missing_NoAnswer_DoesntKnow',
            'HoH_LengthOfStayName_One month or more, but less than 90 days',
            'HoH_LengthOfStayName_One night or less',
            'HoH_LengthOfStayName_One week or more, but less than one month',
            'HoH_LengthOfStayName_One year or longer',
            'HoH_LengthOfStayName_Two to six nights',
            'HoH_RaceName_American Indian, Alaska Native, or Indigenous',
            'HoH_RaceName_Asian or Asian American',
            'HoH_RaceName_Black, African American, or African',
#            'HoH_RaceName_Missing_NoAnswer_DoesntKnow',
            'HoH_RaceName_Native Hawaiian or Pacific Islander',
            'HoH_RaceName_Two or more races',
            'HoH_RaceName_White',
            'HoH_EthnicityName_Hispanic/Latina/e/o',
 #           'HoH_EthnicityName_Non-Hispanic/Latina/e/o',
            'HoH_GenderName_Man (Boy, if child)',
  #           'HoH_GenderName_Other_Missing',
            'HoH_GenderName_Woman (Girl, if child)',
            'HoH_SexualOrientationName_Bisexual',
            'HoH_SexualOrientationName_Gay_Lesbian',
            'HoH_SexualOrientationName_Heterosexual',
   #         'HoH_SexualOrientationName_Other_Missing',
    #      Household_Veteran_0
            'Household_Veteran_1',
            'Household_Veteran_2',
            'HoH_TimesHomelessPastThreeYearsName_Four or more times',
     #        'HoH_TimesHomelessPastThreeYearsName_Missing_NoAnswer_DoesntKnow',
             'Household_Education_10',
             'Household_Education_11',
             'Household_Education_12',
             'Household_Education_13',
             'Household_Education_14',
             'Household_Education_15',
             'Household_Education_6',
            'Household_Education_7',
            'Household_Education_9',
            'Household_Education_Less than Grade 6',
#'Household_Education_Missing_NoAnswer_DoesntKnow',
            #'Household_Employment_0',
            'Household_Employment_1',
            'Household_Employment_2',
#             'HoH_IncomeFromAnySource_Missing_NoAnswer_DoesntKnow',
            'HoH_IncomeFromAnySource_No (HUD)',
            'HoH_IncomeFromAnySource_Yes (HUD)',
            'HoH_HouseholdPercentofAMI_10% - <30%',
            'HoH_HouseholdPercentofAMI_30% - < 50%',
            'HoH_HouseholdPercentofAMI_50% - <80%',
            'HoH_HouseholdPercentofAMI_< 10%',
#             'HoH_HouseholdPercentofAMI_Missing_NoAnswer_DoesntKnow',
            'Household_NonCashBenefitAnySource_0',
            'Household_NonCashBenefitAnySource_1',
            'Household_NonCashBenefitAnySource_2',
            #'Household_AvgInsurance_0'
            'Household_AvgInsurance_1',
            'Household_AvgInsurance_2',
            #'Household_DisablingConditionMax_0',
            'Household_DisablingConditionMax_1',
            'Household_DisablingConditionMax_2',
            #'Household_Pregnant_0',
            'Household_Pregnant_1',
            'Household_Pregnant_2',
            'Household_DomesticViolenceSurvivor_0',
            'Household_DomesticViolenceSurvivor_1',
            'Household_DomesticViolenceSurvivor_2',
            #'Household_MostRecentDomsticViolence_0.0',
            'Household_MostRecentDomsticViolence_2.0',
            'Household_MostRecentDomsticViolence_3.0',
            'Household_MostRecentDomsticViolence_4.0',
            'Household_MostRecentDomsticViolence_5.0',
            #'Household_FleeingDomesticViolence_0',
            'Household_FleeingDomesticViolence_1',
            'Household_FleeingDomesticViolence_2',
            #'Household_PhysicalDisability_0',
            'Household_PhysicalDisability_1',
            'Household_PhysicalDisability_2',
            #'Household_DevelopmentalDisability_0',
            'Household_DevelopmentalDisability_1',
            'Household_DevelopmentalDisability_2',
            #'Household_ChronicHealthCondition_0',
            'Household_ChronicHealthCondition_1',
            'Household_ChronicHealthCondition_2',
            #'Household_HIVAIDS_0',
            'Household_HIVAIDS_1',
            'Household_HIVAIDS_2',
            #'Household_MentalHealthProblem_0',
            'Household_MentalHealthProblem_1',
            'Household_MentalHealthProblem_2',
            #'Household_SubstanceAbuse_0',
            'Household_SubstanceAbuse_1',
            'Household_SubstanceAbuse_2',
            'Household_Unemployment_0',
            'Household_Unemployment_1',
            #'Household_Unemployment_None',
            #'Household_SSI_0',
            'Household_SSI_1',
            'Household_SSI_None',
            #'Household_SSDI_0',
            'Household_SSDI_1',
            'Household_SSDI_None',
            'Household_VADisabilityService_0',
            'Household_VADisabilityService_1',
            #'Household_VADisabilityService_None',
            'Household_TANF_0',
            'Household_TANF_1',
            #'Household_TANF_None',
            'Household_GA_0',
            'Household_GA_1',
            #'Household_GA_None',
            'Household_SocSecRetirement_0',
            'Household_SocSecRetirement_1',
            #'Household_SocSecRetirement_None',
            'Household_ChildSupport_0',
            'Household_ChildSupport_1',
            #'Household_ChildSupport_None',
            'Household_SNAP_0',
            'Household_SNAP_1',
            #'Household_SNAP_None',
#            'Household_N_children0_3_0',
            'Household_N_children0_3_1',
            'Household_N_children0_3_2+',
 #           'Household_N_children3_5_0',
            'Household_N_children3_5_1',
            'Household_N_children3_5_2+',
#            'Household_N_children5_10_0',
            'Household_N_children5_10_1',
            'Household_N_children5_10_2+',
#            'Household_N_children10_15_0',
            'Household_N_children10_15_1',
            'Household_N_children10_15_2+',
#            'Household_N_children15_17_0',
            'Household_N_children15_17_1',
            'Household_N_children15_17_2+',
#            'HoH_OtherIncomeCombined_0',
            'HoH_OtherIncomeCombined_1'
             ] 

X_all_OHE = list(set().union(X_hoh_OHE, X_house_OHE))

X_hoh_WOE = ['RRH', 'TSH', 'PSH',  'HoH_AgeAtEntry',
             'ln_rmout_AverageLHEventsInPast12Months',
             'ln_rmout_HoH_EmployedHoursWorkedLastWeek',
             'ln_N_Household',  'HoH_LengthOfStayName', 'HoH_RaceName',
             'HoH_EthnicityName', 'HoH_GenderName', 'HoH_SexualOrientationName',
             'HoH_VeteranStatusName', 'HoH_TimesHomelessPastThreeYearsName',
             'HoH_LastGradeCompletedNameAtEntry', 'HoH_Employed', 
             'HoH_IncomeFromAnySource', 'HoH_HouseholdPercentofAMI',
             'HoH_CoveredByHealthInsurance', 'HoH_DisablingCondition',
             'HoH_Pregnant', 'HoH_DomesticViolenceSurvivor',
             'HoH_DomesticViolenceWhenOccurred',
             'HoH_DomesticViolenceCurrentlyFleeing',
             'HoH_PhysicalDisability', 'HoH_DevelopmentalDisability',
             'HoH_ChronicHealthCondition', 'HoH_HIVAIDS', 'HoH_MentalHealth',
             'HoH_SubstanceAbuse', 'HoH_Unemployment',
             'HoH_SSI', 'HoH_SSDI', 'HoH_VADisabilityService', 'HoH_TANF',
             'HoH_GA', 'HoH_SocSecRetirement', 'HoH_ChildSupport',
             'HoH_SNAP', 'Household_N_children0_3',
             'Household_N_children3_5', 'Household_N_children5_10',
             'Household_N_children10_15', 'Household_N_children15_17',
             'HoH_OtherIncomeCombined']

X_house_WOE = ['RRH', 'TSH', 'PSH',  'HoH_AgeAtEntry',
               'ln_rmout_AverageLHEventsInPast12Months',
               'ln_rmout_HoH_EmployedHoursWorkedLastWeek',
               'ln_N_Household',  'HoH_LengthOfStayName', 'HoH_RaceName',
               'HoH_EthnicityName', 'HoH_GenderName',
               'HoH_SexualOrientationName',
               'Household_Veteran', 'HoH_TimesHomelessPastThreeYearsName',
               'Household_Education', 'Household_Employment',
               'HoH_IncomeFromAnySource', 'HoH_HouseholdPercentofAMI',
               'Household_AvgInsurance', 'Household_DisablingConditionMax',
               'Household_Pregnant', 'Household_DomesticViolenceSurvivor',
               'Household_MostRecentDomsticViolence',
               'Household_FleeingDomesticViolence',
               'Household_PhysicalDisability',
               'Household_DevelopmentalDisability',
               'Household_ChronicHealthCondition', 'Household_HIVAIDS',
               'Household_MentalHealthProblem',
               'Household_SubstanceAbuse', 'Household_Unemployment',
               'Household_SSI', 'Household_SSDI',
               'Household_VADisabilityService',
               'Household_TANF',
               'Household_GA', 'Household_SocSecRetirement',
               'Household_ChildSupport',
               'Household_SNAP', 'Household_N_children0_3',
               'Household_N_children3_5', 'Household_N_children5_10',
               'Household_N_children10_15', 'Household_N_children15_17',
               'HoH_OtherIncomeCombined']

X_all_WOE = list(set().union(X_hoh_WOE, X_house_WOE))

X_notCat_WOE = ['RRH',
                'TSH',
                'PSH',
                'HoH_AgeAtEntry',
                'ln_rmout_AverageLHEventsInPast12Months',
                'ln_rmout_HoH_EmployedHoursWorkedLastWeek',
                'ln_N_Household'
               ]
def ywoexmatch(yval, xlist):
    '''
    This function transforms the X variable list for WOE encoders. The WOE
    encoders depend on the value of y, so rather than generate 6 lists of 
    x variables (one for each y) and converts the names to WOE represenation
    
    Parameters
    ----------
    yval : String
        DESCRIPTION. name of y variable used
    xlist : List
        DESCRIPTION. List of x variables to rename into WOE representation

    Returns
    -------
    Xvars : TYPE
        DESCRIPTION.

    '''
    
    Xvars = [f'woe_{yval}_{x}' if x not in X_notCat_WOE else x for x in xlist]
    return Xvars